<script>
  import { onMount } from 'svelte';
  import { domCookie } from "cookie-muncher";
  import moond from '../../images/moond.svg';
  import sunw from '../../images/sunw.svg';

  let darkMode = false;
  let searchQuery = '';

  const toggleTheme = () => {
    darkMode = !darkMode;
    if (darkMode) {
      document.body.classList.add('dark');
    } else {
      document.body.classList.remove('dark');
    }
    saveUserChoice(darkMode);
  };

  /**
 * @param {boolean} isDarkModeEnabled
 */
  function saveUserChoice(isDarkModeEnabled) {
    const cookie = {
      name: "darkMode",
      value: isDarkModeEnabled ? "enabled" : "disabled"
    };
    domCookie.set(cookie);
  }

  function loadUserChoice() {
    const cookie = domCookie.get("darkMode");
    if (cookie) {
      if (cookie.value === "enabled") {
        darkMode = true;
        document.body.classList.add('dark');
      } else {
        darkMode = false;
        document.body.classList.remove('dark');
      }
    } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      darkMode = true;
      document.body.classList.add('dark');
      saveUserChoice(true);
    }
  }

  onMount(loadUserChoice);
</script>



<div class="grid-cols-3 grid justify-items-center place-items-center py-0 w-screen bg-white dark:bg-black z-50">

  <div class="justify-self-start ml-8">
    <a href="/">
      <svg class="mx-3 h-24 w-24 text-black dark:text-white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2210.000000 780.000000" preserveAspectRatio="xMidYMid meet">
        <g transform="translate(0.000000,780.000000) scale(0.100000,-0.100000)" fill="currentColor" stroke="none">
          <path d="M1242 7573 c-38 -60 -248 -380 -466 -712 -218 -332 -395 -605 -394 -606 2 -2 93 33 203 76 239 95 593 225 725 267 134 42 231 56 358 49 143 -7 282 -56 376 -130 l28 -23 -194 -181 c-106 -99 -317 -306 -468 -459 -481 -487 -776 -823 -1109 -1261 l-123 -162 42 -128 c341 -1028 856 -1764 1552 -2217 263 -171 521 -270 843 -322 154 -25 542 -30 735 -10 469 50 957 183 1545 424 94 38 209 88 258 110 l87 41 1 118 c1 145 13 370 20 377 2 3 74 -20 159 -51 321 -115 594 -214 600 -218 8 -5 -13 -280 -45 -610 -45 -458 -110 -867 -191 -1205 -37 -154 -112 -426 -139 -499 -8 -24 -13 -46 -11 -48 2 -2 129 76 282 173 154 97 545 343 869 546 325 204 589 373 587 376 -32 79 -76 233 -92 322 -39 219 -62 510 -41 510 9 0 411 -143 1000 -356 128 -46 237 -84 241 -84 18 0 292 385 442 620 540 846 851 1669 954 2520 24 195 24 539 0 704 -85 594 -324 1085 -754 1551 -168 182 -537 503 -564 492 -7 -3 -276 -217 -598 -475 -322 -259 -586 -469 -587 -468 -1 1 7 109 17 241 10 132 16 243 12 247 -9 9 -531 168 -1022 312 -179 52 -369 108 -422 124 l-97 30 -158 -201 c-491 -625 -518 -660 -506 -664 6 -2 49 -23 95 -45 46 -23 225 -107 398 -188 258 -121 316 -152 321 -171 7 -24 21 -396 39 -1034 5 -181 12 -619 16 -971 l7 -642 -44 -45 c-24 -25 -197 -190 -384 -367 -187 -177 -360 -342 -383 -366 -97 -99 -583 -303 -913 -382 -246 -60 -311 -67 -594 -67 -224 0 -277 3 -380 22 -207 38 -409 106 -576 195 -79 42 -261 167 -266 184 -4 12 181 127 321 200 283 148 539 235 846 286 l133 23 -2 574 c-1 315 -4 581 -6 590 -6 35 -17 2051 -10 2051 17 0 333 -82 435 -114 63 -19 193 -64 288 -99 95 -36 174 -61 177 -58 2 4 101 234 221 512 119 277 252 586 295 687 44 101 79 186 79 189 0 3 -19 2 -42 -1 -168 -25 -582 -64 -938 -88 -248 -17 -1441 -17 -1760 0 -347 19 -778 49 -1010 72 -113 11 -215 20 -227 20 -16 0 -38 -25 -91 -107z m6654 -1498 c156 -46 404 -297 589 -595 246 -397 430 -935 502 -1470 13 -102 18 -199 18 -400 0 -242 -2 -273 -23 -355 -61 -243 -183 -367 -387 -397 l-81 -11 -254 118 c-305 141 -608 282 -860 399 l-185 86 2 217 c4 376 31 1020 74 1723 l21 345 36 54 c49 73 155 186 211 224 108 74 225 95 337 62z m-5397 -67 c82 -278 90 -580 51 -1888 -13 -431 -52 -633 -155 -814 -40 -70 -134 -196 -145 -196 -3 1 -30 33 -61 73 -155 199 -303 483 -388 747 -117 358 -114 803 6 1175 97 303 265 568 538 853 64 67 120 122 125 122 4 0 17 -33 29 -72z"/>
          <path d="M13835 7563 c-129 -20 -203 -46 -690 -243 -309 -125 -663 -257 -1100 -410 -454 -159 -1169 -442 -1308 -518 -183 -99 -222 -314 -125 -682 64 -243 167 -542 287 -834 115 -279 142 -366 166 -554 48 -364 -35 -712 -270 -1133 -113 -203 -336 -522 -528 -757 -33 -40 -57 -75 -54 -78 9 -9 822 -177 2342 -485 l940 -190 120 4 c203 7 293 59 405 236 36 56 137 209 225 339 148 219 315 476 315 485 0 2 -147 7 -327 10 -812 17 -1454 99 -2186 278 -92 23 -167 45 -165 50 2 4 136 115 298 246 743 601 966 790 1110 940 126 131 179 211 213 318 19 61 22 91 21 235 0 142 -6 194 -37 375 -65 381 -89 653 -90 1015 0 237 15 513 32 578 7 25 14 28 117 49 240 48 550 85 832 99 95 5 132 10 132 19 0 30 -55 178 -101 270 -80 162 -192 283 -299 321 -45 16 -215 27 -275 17z m-1367 -1174 c-19 -131 -16 -711 5 -944 29 -316 32 -434 13 -585 -49 -381 -142 -678 -259 -818 -41 -50 -85 -88 -91 -81 -2 2 0 31 5 64 11 89 10 418 -1 536 -17 163 -46 322 -115 619 -122 529 -128 559 -129 660 0 74 5 109 23 160 41 115 129 220 263 311 62 43 290 170 295 165 2 -1 -3 -40 -9 -87z"/>
          <path d="M16435 7445 c-558 -215 -912 -374 -1091 -490 -342 -222 -436 -484 -310 -859 31 -90 239 -577 416 -971 302 -672 426 -1093 390 -1321 -31 -195 -224 -450 -697 -923 -151 -150 -271 -277 -266 -281 23 -22 1772 -910 1792 -910 5 0 38 53 73 118 36 64 98 176 138 247 193 346 280 502 356 638 46 82 84 152 84 156 0 5 -57 23 -127 41 -147 37 -324 95 -468 152 -189 75 -435 218 -417 242 456 594 710 1033 753 1301 21 134 -9 332 -84 550 -47 138 -86 226 -173 394 -41 79 -74 147 -74 151 0 21 376 365 537 491 144 113 217 149 299 149 110 0 220 -46 409 -170 61 -40 111 -73 113 -75 1 -1 -13 -274 -33 -606 -19 -332 -50 -894 -69 -1249 -37 -684 -46 -785 -77 -920 -45 -196 -157 -463 -253 -604 -25 -36 -46 -68 -46 -71 0 -2 66 -61 148 -132 435 -378 601 -539 796 -773 l29 -35 34 40 c19 22 168 202 331 400 163 198 351 427 419 509 68 82 123 154 123 160 0 6 -21 20 -47 30 -60 25 -163 126 -198 196 -55 109 -86 223 -106 390 -14 123 -11 326 26 1490 14 437 25 854 25 925 0 219 36 386 112 526 l33 61 56 -6 c75 -7 242 -63 359 -119 134 -64 601 -361 749 -475 l23 -19 -86 -122 c-223 -318 -323 -538 -363 -801 -14 -89 -16 -223 -17 -895 -1 -706 1 -805 17 -935 78 -627 282 -986 693 -1224 86 -50 255 -126 279 -126 8 0 29 28 46 63 17 34 86 163 151 287 66 124 163 306 216 405 52 99 122 229 154 289 32 61 57 114 55 119 -1 5 -23 17 -48 27 -122 46 -245 163 -310 295 -64 128 -82 238 -81 485 0 218 37 1473 48 1625 41 606 244 1038 623 1326 l34 25 -89 33 c-215 81 -396 157 -584 245 -189 89 -289 141 -745 386 -99 53 -252 136 -341 184 -88 47 -165 86 -171 86 -9 0 -183 -180 -642 -665 -73 -77 -139 -141 -146 -143 -18 -4 -189 91 -333 184 -61 40 -190 136 -285 212 -239 192 -540 412 -564 412 -5 0 -107 -100 -228 -221 -121 -122 -355 -352 -520 -513 -165 -160 -405 -394 -533 -520 -177 -172 -236 -225 -243 -215 -22 34 -93 231 -115 317 -28 112 -32 260 -9 338 21 71 84 154 161 212 74 55 233 137 337 172 37 13 67 27 67 31 0 4 -32 84 -71 176 -39 92 -76 180 -82 196 -6 15 -18 27 -27 26 -8 0 -159 -56 -335 -124z"/>
        </g>
      </svg> 
    </a>
  </div>

  <div class="invisible xl:visible 2xl:visible">
    <a class="link transition-shadow font-link text-base text-black dark:text-white mx-3" href="/">Accueil</a>
    <a class="link transition-shadow font-link no-underline text-base text-black dark:text-white mx-3" href="/vetements">Vêtements</a>
    <a class="link transition-shadow font-link no-underline text-base text-black dark:text-white mx-3" href="/collections">Collections</a>
    <a class="link transition-shadow font-link no-underline text-base text-black dark:text-white mx-3" href="/histoire">Histoire</a>
  </div>
  
  <div class="flex justify-self-end mr-8 invisible xl:visible 2xl:visible">
    <form>
      <div class="relative">
        <input type="search" id="default-search" class="mx-3 p-2 h-6 w-36 rounded-3xl bg-gray-100 dark:bg-gray-900 text-black dark:text-white focus:outline-none focus:ring-2 focus:ring-gray-300 dark:focus:ring-gray-700 block text-gray-900" placeholder="Article" required>
        <button type="submit" class="text-white absolute end-1.5 bottom-[2.6px]">
          <svg class="mx-3 h-5 w-5 text-black hover:text-gray-600 dark:text-white dark:hover:text-gray-300" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet">
            <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="currentColor" stroke="none">
              <path d="M1916 4850 c-953 -120 -1656 -910 -1656 -1860 0 -804 521 -1525 1280 -1774 471 -154 953 -123 1398 90 113 53 265 148 352 217 l45 37 640 -640 c441 -440 649 -641 668 -646 44 -10 112 1 145 24 54 39 80 138 51 195 -6 12 -296 308 -645 657 l-634 635 37 45 c68 85 155 225 214 345 496 1012 -23 2237 -1097 2591 -195 64 -323 85 -544 89 -102 2 -216 0 -254 -5z m532 -349 c205 -45 412 -136 579 -254 106 -75 270 -235 346 -337 457 -620 395 -1472 -148 -2015 -55 -55 -128 -120 -163 -145 -306 -220 -646 -324 -1002 -306 -228 11 -401 57 -615 161 -419 206 -722 597 -826 1067 -14 65 -22 146 -26 268 -5 149 -2 193 16 299 111 653 607 1152 1260 1271 144 27 440 22 579 -9z"/>
            </g>
          </svg>
        </button>
      </div>
    </form>


    <a href="/panier">
      <svg class="mx-3 h-6 w-6 text-black dark:text-white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet">
        <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="currentColor" stroke="none">
          <path d="M415 4786 c-94 -42 -124 -169 -58 -247 46 -54 71 -59 295 -59 175 0 209 -3 243 -19 43 -19 91 -68 106 -109 5 -13 32 -162 59 -331 28 -168 125 -758 217 -1310 178 -1070 170 -1036 236 -1085 l28 -21 1326 -3 c1314 -2 1327 -2 1367 18 23 11 50 32 60 46 24 33 505 1950 506 2012 0 59 -24 107 -69 134 l-36 23 -1640 5 -1640 5 -46 273 c-50 297 -59 332 -96 406 -31 60 -119 155 -183 196 -103 66 -141 73 -405 77 -188 2 -247 0 -270 -11z m4015 -1273 c0 -5 -88 -365 -197 -801 l-198 -792 -1150 2 -1149 3 -133 785 c-72 432 -132 791 -133 798 0 9 302 12 1480 12 814 0 1480 -3 1480 -7z"/>
          <path d="M1801 1264 c-253 -68 -410 -331 -346 -579 67 -256 329 -415 580 -350 256 67 415 329 350 578 -67 259 -333 419 -584 351z m182 -318 c103 -43 128 -177 48 -257 -65 -65 -157 -65 -222 0 -124 123 13 325 174 257z"/>
          <path d="M3721 1264 c-253 -68 -410 -331 -346 -579 67 -256 329 -415 580 -350 256 67 415 329 350 578 -67 259 -333 419 -584 351z m182 -318 c103 -43 128 -177 48 -257 -65 -65 -157 -65 -222 0 -124 123 13 325 174 257z"/>
        </g>
      </svg>      
    </a>
    <button class="mx-3" on:click={toggleTheme}>
      <img src={darkMode ? sunw : moond} alt={darkMode ? 'Thème Clair' : 'Thème Sombre'}>
    </button>

  </div>
</div>

<style>
  @import "./Navbar.css";
</style>